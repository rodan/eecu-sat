# eecu-sat(1) - (Engine Electronic Control Unit signal acquisition tool) software application that imports, calibrates, crops and splices Logic raw analog signals and converts them into sigrok-compatible session files that can be visualised in pulseview.

SEPTEMBER 2024

```
eecu-sat [-hv] [-i, --input FILENAME_MATCH ] [-o, --output FILE_PREFIX ] [-O, --output-format OUTPUT ] [-t, --triggers TRIGGERS ] [-T, --transform-module TRANSFORM ] [-L, --list]
```

<a name="description"></a>

# Description

**eecu-sat**
imports raw analog signals generated by Logic, optionally applies a trigger that can crop a slice of it, optionally calibrates each channel of the signal via the transform module and in the end exorts the data either in raw analog format or as a sigrok session file.


<a name="options"></a>

# Options


* -h  
  Display short help message and exit
* -v  
  Display application version
* -i, --input FILENAME_MATCH  
  
  Imports either a singular file or a list of files defined by and extended pattern, see man 3 
  _fnmatch_
  _FNM_EXTMATCH_
  for details. the list is parsed in alpha-numerical order (analog_2 comes before analog_10).
  
  default value is 
  **analog_[0-9]*.bin**
  
* -O, --output_format FORMAT  
  
  Mandatory option that sets the export file format. the list of possible FORMATs is obtained by using
  _-L_
  
  the FORMAT argument can be followed by module-specific options by using the 
  _:_
  separator.
  
  .B
  analog
  - export is kept as a raw analog signal containing little-endian single precision floating-point data. the &lt;SALEAE&gt; header is copied over if it was present in the input file. see https://support.saleae.com/faq/technical-faq/binary-export-format-logic-2
  
  .B
  analog:channel_offset=NUM
   - all exported channel identifiers get incremented by NUM. useful for creating sessions that contain signals from different captures.
  
  .B
  srzip
  - sigrok session file. an archive containing non-interlaced channel data and information about the channel labeling and sample rate.
  
  .B
  srzip:metadata_file=FILE
  - force the output module to use FILE as the metadata inside the srzip instead of automatically generating it. good for labeling the channels.
  
  .B
  calibrate_linear_3p:calib_file=FILE
  - very specialised option that generates pairs of slope and offset for each channel - to be used to calibrate signals further on. this option needs a special signal input that features stable voltages of known values in the -0.6 - 0 - 15V intervals. the parameters are to be used with a 3 point linear-interpolated calibration.
  
* -o, --output FILE_PREFIX  
  
  either an exact filename (for srzip) or a prefix like 'analog_' when used with --output-format analog. in the second case the channel identifier and the 'bin' extension is added automatically.
  
  
* -t, --triggers TRIGGERS  
  
  find samples that match a trigger definition. this can be used to export a cropped part of the signal.
  
  the following sub-options need to be defined and separated by ':'
  
  .B
  ch=FILENAME:name=STR:type=CHAR:level=VOLTAGE:nth=INT:a=INT:b=INT
  
  **ch=FILENAME**
  defines the signal channel on which the trigger will be set. it's actually a filename without any path.
  
  **name=STR**
  a trigger name, like Jeff. good for better understanding possible errors or warnings that the application throws.
  
  **type=CHAR**
  for analog signals TYPE it's either 
  **o**
  or
  **u**
  so it's a rising signal over the defined level or a falling one respectively.
  
  **level=X.YZ**
  an approximate (in floating-point terms) voltage at which the trigger should occur. this voltage is read directly from the input source, since the triggering module is run before the transformation module.
  
  **nth=INT**
  a positive integer sets the final trigger once the definition was matched an INT number of times.
  
  **b=INT**
  crop the signal INT number of samples before the trigger
  
  **a=INT**
  crop the signal INT number of samples after the trigger
  
* -T, --transform-module TRANSFORM  
  Optional module that performs a transformation of the input data. the list of possible TRANSFORMs is obtained by using
  _-L_
  
  the TRANSFORM argument can be followed by module-specific options by using the 
  _:_
  separator.
  
  .B
  calibrate_linear_3p:calib_file=FILE
   - use the parameters provided in FILE in order to perform a 3 point linear-interpolated calibration of the input signal
  
  the calib_file format is as follows:
  
  .EX
  --------- calib.ini ----- &gt;8 --------------------------
  [globals]
  r_0 = 0.0             # source voltage, 1st point
  r_1 = 1.6             # source voltage, 2nd point
  r_2 = 8.0             # source voltage, 3rd point
  r_acc = 0.1           # match accuracy in volts
  r_stab = 0.01         # stability criteria
  r_stab_cnt = 10000    # minimal number of stable samples
  r_oob_floor = -10.0   # out-of-bounds lower limit
  r_oob_ceil = 10.0     # out-of-bounds upper limit
  t_0 = 0.0             # target voltage, 1st point
  t_1 = 2.4997          # target voltage, 2nd point
  t_2 = 11.974          # target voltage, 3rd point
  
  [CH1]
  type=1                # calibration type - 3p linear
  midpoint=1.667258     # 2nd point source voltage
  slope_0=1.503436      # params for 1st 2p calib
  offset_0=-0.006914    # -/-
  slope_1=1.501993      # params for 2nd 2p calib
  offset_1=-0.004509    # -/-
  
  [CH2]                 # repeat for all channels
  type=1
  [..]
  ------------------------ 8&lt; ---------------------------
  .EE
  
* -L, --list  
  Provides a list of output and transformation modules that have been compiled into the application.
  

<a name="example"></a>

# Example


get all raw analog files defined by analog_[0-9]*.bin, crop the signal based on a trigger on the 6th channel (when the signal rises above 3.4V the 11th time and keep 5000 samples before the trigger and 1000 after it). then calibrate this signal slice and use a custom metadata in the output session file:

.EX
eecu-sat -i "${sample_dir}/analog_[0-9]*.bin" -t "ch=analog_5.bin:type=o:level=3.40:name=jeff:nth=11:b=5000:a=1000" --transform-module "calibrate_linear_3p:calib_file=${sample_dir}/calib_reference.ini" -o ./calibrated.sr --output-format "srzip:metadata_file=${sample_dir}/metadata_16ch"
.EE


<a name="diagnostics"></a>

# Diagnostics

errors are generated on stderr if any of the system calls returns a failure.
 

<a name="bugs"></a>

# Bugs

please report any bugs via the github tracker located at &lt;https://github.com/rodan/eecu-sat/issues&gt;

<a name="license"></a>

# License

**eecu-sat**
is covered by the GNU General Public License (GPLv3 or later).

<a name="author"></a>

# Author

Petre Rodan &lt;[2b4eda@subdimension.ro](mailto:2b4eda@subdimension.ro)&gt;

<a name="see-also"></a>

# See Also

**fnmatch**(3)
,
**sigrok-cli**(1)
,
**pulseview**(1)
